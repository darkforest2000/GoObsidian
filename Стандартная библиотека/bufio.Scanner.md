Вы, наверно, заметили, что методы `os.File.Read()` и `bufio.Reader.Read()` с их фиксированным буфером больше подходят для работы с бинарными файлами. Текстовые же файлы отличаются тем, что состоят из кусочков данных переменной длины (например, строк), разделенных одним и тем же разделителем (например, символом перевода строки).

Для работы с текстовыми файлами в Go удобно использовать тип `bufio.Scanner`. Он как раз начитывает данные порциями (_токенами_), ориентируясь на разделитель, а не на размер буфера.

Допустим, есть файл `people.txt` c таким содержимым:

```no-highlight
Дарья
Борис
Елена
Ксения
Леонид
```

Прочитаем его построчно:

```go
file, err := os.Open("people.txt")
if err != nil {
    panic(err)
}
defer file.Close()

scanner := bufio.NewScanner(file)  // (1)
for scanner.Scan() {               // (2)
    line := scanner.Text()         // (3)
    fmt.Printf("%#v\n", line)
}

if err := scanner.Err(); err != nil {  // (4)
    panic(err)
}
```

```no-highlight
"Дарья"
"Борис"
"Елена"
"Ксения"
"Леонид"
```

Мы создаем сканер на базе файла ➊. Каждый вызов метода `Scan()` ➋ начитывает и запоминает внутри сканера очередной токен — порцию данных до разделителя (разделитель по умолчанию — `\n`). Метод `Text()` возвращает токен в виде строки ➌.

Если достигнут конец файла, метод `Scan()` возвращает `false`. Поэтому нам не приходится дополнительно проверять на `io.EOF`. Кроме того, `Scan()` возвращает `false` при первой же ошибке, поэтому мы проверяем значение `Err()` сразу после выхода из цикла ➍.

`bufio.Scanner` подходит для любых данных с разделителем, не обязательно строк. Допустим, `people.txt` выглядит так:

```no-highlight
Дарья Борис Елена Ксения Леонид
```

Прочитаем его по словам:

```go
// ...

scanner := bufio.NewScanner(file)
scanner.Split(bufio.ScanWords)    // (1)
for scanner.Scan() {
    word := scanner.Text()
    fmt.Printf("%#v\n", word)
}

// ...
```

Код отличается от предыдущего примера только строчкой ➊. Метод `Split()` устанавливает функцию, которая отдает очередную порцию данных до разделителя. Пакет `bufio` предоставляет четыре таких функции:

-   `ScanLines` разбивает строки по `\n` или `\r\n` (используется по умолчанию).
-   `ScanWords` разбивает слова по пробельным символам.
-   `ScanRunes` начитывает отдельные руны.
-   `ScanBytes` начитывает отдельные байты.

`bufio.Scanner` начитывает данные с диска переменным буфером размером от 4 до 64 Кб. Если очередной токен не вместится в буфер, `Scan()` не сможет его прочитать и вернет ошибку. Изменить умолчательный и максимальный размер буфера можно через метод `Buffer()`.

[[Стандартная библиотека]]